<div class="main-chat-list">
  <div class="chat-list-header">
    <h4>Chat</h4>
    @if (!searchNewContact) {
    <i
      class="fas fa-comment-medical cursor-pointer"
      (click)="searchContact()"
    ></i>
    }@else {
    <i
      class="fas fa-times-circle cursor-pointer"
      (click)="searchNewContact = false"
    ></i>
    }
  </div>
  <div class="d-flex flex-column gap-2 p-2">
    <div class="input-group">
      <span>
        <i class="fas fa-search"></i>
      </span>
      <input
        type="text"
        class="form-control"
        placeholder="Search in the chat"
        aria-label="Search"
      />
    </div>
    <div class="d-flex gap-2">
        <span class="badge rounded-pill text-bg-light cursor-pointer">All</span>
        <span class="badge rounded-pill text-bg-light cursor-pointer">Unread</span>
        <span class="badge rounded-pill text-bg-light cursor-pointer">Starred</span>
    </div>
  </div>

</div>
<div class="chats-list ml-3">
@if (chats().length && !searchNewContact) {
  @for(chat of chats(); track chat.id) {
    <div class="d-flex justify-content-between align-items-center gap-2 p-2 border-bottom-grey" (click)="chatClicked(chat)">
      <div class="d-flex gap-2">
        <img
          class="rounded-circle"
          src="user.png"
          alt="Chat Image"
          width="50"
          height="50"
        />
        <div class="d-flex flex-column">
          <span class="fw-bold">{{ chat.name }}</span>
          <small class="text-secondary">
            @if (chat.lastMessage==='Attachement') {
              <i class="fas fa-paperclip"></i>
            } 
            {{wrapMessage(chat.lastMessage)}}
          </small>
        </div>
        <div class="d-flex flex-column align-items-end">
          <span class="text-secondary">{{ chat.lastMessageTime | date: 'shortTime' }}</span>
          @if (chat.unreadCount && chat.unreadCount > 0) {
            <span class="badge rounded-pill text-bg-primary">{{ chat.unreadCount }}</span>
          }
      </div>
      </div>
    </div>
  }
}@else if (searchNewContact) {
  @for (contact of contacts; track contact) {
    <div class="d-flex justify-content-between align-items-center gap-2 p-2 border-bottom-grey" (click)="contactClicked(contact)">
      <div class="d-flex gap-2">
        <img
          class="rounded-circle"
          src="user.png"
          alt="Contact Image"
          width="50"
          height="50"
        />
        <div class="d-flex flex-column">
          <span class="fw-bold">{{ contact.firstName +' '+contact.lastName}}</span>
          @if (contact.online) {
          <small class="text-success">Online</small>
          } @else {
          <small class="text-secondary">Last seen {{contact.lastSeen |date: 'shortTime'}}</small>
          }   
      </div>
      </div>
      <button class="btn btn-primary" (click)="addContact(contact)">Add</button>
    </div>
  }
}@else {
  <div class="text-center p-5">
    <h5 class="text-secondary">No chats found</h5>
  </div>
}

</div>